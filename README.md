trapsim-notebooks
=================

This set of notebooks, ROOT scripts, and shell scripts constitute
something of a stack for doing simulations and analysis of surface
electrode traps. A few ROOT scripts take a `.dxf` trap layout file and
run BemSolver on them to get the potential contribution of each
electrode. Then use the notebooks to visualize potentials, fit
electrodes to a target potential, and find equilibrium positions.

To run the BemSolver scripts, first make a directory under `bemsolver`
for the trap you wish to simulate.

	mkdir bemsolver/newsimulation
	cd bemsolver/newsimulation

Add your `.dxf` layout file as `layout.dxf`. To compute the electrode
potentials, you will need to define a grid to compute on. Here is an
example of what to put in `grid.txt`:

	---
	num_electrodes: 10
	dimx: 21
	dimy: 21
	dimz: 21
	startx: -50
	starty: -100
	startz: 150
	endx: 50
	endy: 100 
	endz: 250

Mind the initial `---`. You'll have to set these values appropriately:
`num_electrodes` is the number of DC electrodes on one side of the trap,
`dimx`, `dimy`, and `dimz` are the number of points to compute on each
axis, and `startx`/`endx`, etc., are the positions to interpolate
between on the grid.

To run BemSolver, stay in your subdirectory and do the following:

	../solve_cache.sh
	../all_fields.sh

The solution cache is computed first so the fields can be calculated in
parallel; try not to forget to run that every time you change the trap.
Then you can put the `.txt` files generated by BemSolver in
`notebooks/data` and run the analysis notebooks on them.
